import type { Metadata } from 'next';
import Script from 'next/script';
import React from 'react';
import StyledJsxRegistry from '@/app/registry';
import axios from 'axios';

import './globals.css';
import { pretendard } from '@/app/font';

import HeaderLayout from '@/components/common/HeaderLayout';
import { RootStoreProvider } from '@/provider/root-store-provider';
import Modal from '@/components/common/Modal';

export const metadata: Metadata = {
  title: 'Create Next App',
  description: 'Generated by create next app',
};

export default async function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  const res = await axios.get('http://jsonplaceholder.typicode.com/posts/');
  const initUser = {
    user: {
      email: 'zxcasd',
    },
  };
  return (
    <html lang="ko" className={pretendard.className}>
      <body>
        <StyledJsxRegistry>
          <RootStoreProvider userData={initUser}>
            <div id="modal-root"></div>
            <Modal></Modal>
            <HeaderLayout></HeaderLayout>
            {children}
          </RootStoreProvider>
        </StyledJsxRegistry>

        <Script src={`https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=${process.env.NAVER_CLIENT_ID}`} strategy={'beforeInteractive'}></Script>
        <Script src={`https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=${process.env.NAVER_CLIENT_ID}&submodules=geocoder`} strategy={'beforeInteractive'}></Script>
      </body>
    </html>
  );
}
